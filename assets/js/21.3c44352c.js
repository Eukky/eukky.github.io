(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{322:function(s,t,a){s.exports=a.p+"assets/img/SSR.09823ee9.png"},323:function(s,t,a){s.exports=a.p+"assets/img/SSSR.803e9a00.png"},324:function(s,t,a){s.exports=a.p+"assets/img/HZBTracing.4d62874b.png"},325:function(s,t,a){s.exports=a.p+"assets/img/PDFRay.8d3424a0.png"},359:function(s,t,a){"use strict";a.r(t);var i=a(14),l=Object(i.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"随机屏幕空间反射-stochastic-screen-space-reflections-sssr"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#随机屏幕空间反射-stochastic-screen-space-reflections-sssr"}},[s._v("#")]),s._v(" 随机屏幕空间反射 Stochastic Screen-Space Reflections (SSSR)")]),s._v(" "),t("p",[s._v("目前主流的反射效果实现方式，都是通过屏幕空间来进行实现，也就是SSR(Screen Space Refletions)。SSR在消耗低廉性能的同时，能够带来相对不错的反射效果，同时该反射效果的实现又不会因为场景的复杂程度而影响，对于延迟渲染而言非常友好。那么先来看看传统的SSR是如何实现的。")]),s._v(" "),t("h2",{attrs:{id:"传统屏幕空间反射-ssr"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#传统屏幕空间反射-ssr"}},[s._v("#")]),s._v(" 传统屏幕空间反射 SSR")]),s._v(" "),t("p",[s._v("传统SSR实现步骤非常简单，主要分为以下几步：")]),s._v(" "),t("ol",[t("li",[s._v("根据GBuffer和Depth重建场景的世界坐标。")]),s._v(" "),t("li",[s._v("从GBuffer发射射线，射线方向根据View向量与Normal求得")]),s._v(" "),t("li",[s._v("使用RayMarching找到反射向量与深度图的交点，如果击中，该点就是该像素点的反射结果。")])]),s._v(" "),t("p",[s._v("可以发现SSR存在以下几个缺点：")]),s._v(" "),t("ol",[t("li",[s._v("场景根据Scene Buffer进行重建，也就是只能反射屏幕中存在的东西。")]),s._v(" "),t("li",[s._v("每一个点的反射都是精确无比的，只能够用来模拟镜面反射，而无法实现例如带有粗糙度的金属质感的模拟。")])]),s._v(" "),t("p",[t("img",{attrs:{src:a(322),alt:"SSR"}})]),s._v(" "),t("p",[s._v("使用UE进行SSR效果的模拟，可以很明显地看到，盒子底面在屏幕中无法看到，因此在反射中也无法进行呈现。")]),s._v(" "),t("h2",{attrs:{id:"对ssr的改进需求"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#对ssr的改进需求"}},[s._v("#")]),s._v(" 对SSR的改进需求")]),s._v(" "),t("p",[s._v("为了更好地模拟各种材质的反射表现，EA在使用寒霜引擎制作镜之边缘的时候，提出了以下几个改进需求")]),s._v(" "),t("ul",[t("li",[s._v("Sharp and blurry reflections 支持清晰和模糊的反射")]),s._v(" "),t("li",[s._v("Conteact hardening 越接近表面反射越锐利")]),s._v(" "),t("li",[s._v("Specular elongation 高光的拉伸")]),s._v(" "),t("li",[s._v("Per-Pixel roughness and normal 能够逐像素处理法线和粗糙度")])]),s._v(" "),t("p",[s._v("于是，他们在Siggraph2015中提出了 Stochastic Screen-Space Reflections 算法来解决上述问题。")]),s._v(" "),t("h2",{attrs:{id:"stochastic-screen-space-reflections-核心原理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#stochastic-screen-space-reflections-核心原理"}},[s._v("#")]),s._v(" Stochastic Screen-Space Reflections 核心原理")]),s._v(" "),t("p",[s._v("该算法的流程图如下所示")]),s._v(" "),t("p",[t("img",{attrs:{src:a(323),alt:"SSSR"}})]),s._v(" "),t("ol",[t("li",[s._v("Tile classification 网格划分")])]),s._v(" "),t("p",[s._v("这一步是通过将屏幕分为多个Tile，在1/8的分辨率下向每个Tile发射射线，根据射线击中信息来判断该Tile的重要性，从而决定这个Tile中的像素需要发射多少射线。")]),s._v(" "),t("p",[s._v("这一步通过分块思想，能够在一定程度上减少射线求交的开销。")]),s._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[s._v("Ray allocation 射线分配")])]),s._v(" "),t("p",[s._v("这一步通过射线与Tile交点的粗糙度来判断应该向这个Tile来发射何种射线。射线根据开销大小被分为两种，开销昂贵的射线在求交时使用Hierarchical Raytracing，也就是通过通常所说的Hi-Z Buffer来进行射线求交，求出精确的交点，而廉价的射线则使用普通的Linear March来进行求交，根据步进大小也可能会跳过屏幕中的微小物体。")]),s._v(" "),t("p",[s._v("这一步通过对粗糙度的划分，更近一步减小了射线求交在算法中的开销。因为粗糙度更大的材质表面或许并不需要过于精确的反射结果。")]),s._v(" "),t("p",[s._v("对于Hierarchical Raytracing，简单来说就是用射线打向Hi-Z Buffer(以下简称为HZB)，如果没有击中，则增加步进的同时使用HZB的下一级Mip再次进行求交，重复该过程直到相交，相交之后降低Mip等级再进行更精细的查找，这一步有种二分法求解的味道。")]),s._v(" "),t("p",[s._v("该算法的伪代码非常简单，这里也一并列出")]),s._v(" "),t("div",{staticClass:"language-cpp line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-cpp"}},[t("code",[s._v("mipLevel "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mipLevel "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    step through current cell"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("above Z plane"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("++")]),s._v("mipLevel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("below Z plane"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("mipLevel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("下图就是该算法的执行过程")]),s._v(" "),t("p",[t("img",{attrs:{src:a(324),alt:"HZBTracing"}})]),s._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[s._v("Importance sampling refresher 重要性采样")])]),s._v(" "),t("p",[s._v("上一步决定了发射的射线采用那种方式进行求交，那么该如何决定射线方向呢，便是使用重要性采样的方式来进行决定。")]),s._v(" "),t("p",[s._v("重要性采样时蒙特卡洛积分中用于减少方差的算法，结论可以简单总结为，当重要性采样中使用的概率密度分布函数(PDF)越接近目标函数，则最终的计算结果则更为接近实际值。")]),s._v(" "),t("p",[s._v("因此在这一步中所需要做的，就是选择一个合适的PDF来进行采样。")]),s._v(" "),t("p",[s._v("由于目前主流PBR渲染中的BRDF都采用GGX函数，因此重要性采样的PDF可以选择使用GGX相关的函数来进行计算。使用PDF来进行射线方向生成时，会有生成的射线方向向地下发射，遇到这种情况便将其舍弃重新生成。如下图所示")]),s._v(" "),t("p",[t("img",{attrs:{src:a(325),alt:"PDFRay"}})]),s._v(" "),t("ol",{attrs:{start:"4"}},[t("li",[s._v("Ray reuse 射线复用")])]),s._v(" "),t("p",[s._v("到此为止已经决定了某个像素点需要发射的射线方向，也已经决定了该射线使用何种方式来与深度进行求交。为了更进一步做到射线的高效率使用，算法提出了射线复用的思想。")]),s._v(" "),t("p",[s._v("邻近像素的可见性可能是不同的，但是如果假设他们相同，我们便可以复用邻近像素的结果来进一步提升采样率。但是根据重要性采样的结果，邻近像素的BRDF的差距可能非常大，因此可能带来巨大的方差，导致结果变得更差。")]),s._v(" "),t("section",[t("eqn",[t("span",{staticClass:"katex-display"},[t("span",{staticClass:"katex"},[t("span",{staticClass:"katex-mathml"},[t("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}},[t("semantics",[t("mrow",[t("mo",[s._v("∫")]),t("mi",[s._v("f")]),t("mo",{attrs:{stretchy:"false"}},[s._v("(")]),t("mi",[s._v("x")]),t("mo",{attrs:{stretchy:"false"}},[s._v(")")]),t("mi",[s._v("d")]),t("mi",[s._v("x")]),t("mo",[s._v("=")]),t("munder",[t("mrow",[t("mi",[s._v("lim")]),t("mo",[s._v("⁡")])],1),t("mrow",[t("mi",[s._v("N")]),t("mo",[s._v("→")]),t("mi",{attrs:{mathvariant:"normal"}},[s._v("∞")])],1)],1),t("mfrac",[t("mn",[s._v("1")]),t("mi",[s._v("N")])],1),t("munderover",[t("mo",[s._v("∑")]),t("mrow",[t("mi",[s._v("k")]),t("mo",[s._v("=")]),t("mn",[s._v("1")])],1),t("mi",[s._v("N")])],1),t("mfrac",[t("mrow",[t("mi",[s._v("f")]),t("mo",{attrs:{stretchy:"false"}},[s._v("(")]),t("msub",[t("mi",[s._v("x")]),t("mi",[s._v("k")])],1),t("mo",{attrs:{stretchy:"false"}},[s._v(")")])],1),t("msub",[t("mi",[s._v("p")]),t("mi",[s._v("k")])],1)],1)],1),t("annotation",{attrs:{encoding:"application/x-tex"}},[s._v(" \\int f(x)dx=\\lim_{N\\rightarrow\\infty}\\frac{1}{N}\\sum^N_{k=1}\\frac{f(x_k)}{p_k} ")])],1)],1)],1),t("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[t("span",{staticClass:"base"},[t("span",{staticClass:"strut",staticStyle:{height:"2.2222em","vertical-align":"-0.8622em"}}),t("span",{staticClass:"mop op-symbol large-op",staticStyle:{"margin-right":"0.44445em",position:"relative",top:"-0.0011em"}},[s._v("∫")]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.1667em"}}),t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.10764em"}},[s._v("f")]),t("span",{staticClass:"mopen"},[s._v("(")]),t("span",{staticClass:"mord mathnormal"},[s._v("x")]),t("span",{staticClass:"mclose"},[s._v(")")]),t("span",{staticClass:"mord mathnormal"},[s._v("d")]),t("span",{staticClass:"mord mathnormal"},[s._v("x")]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}}),t("span",{staticClass:"mrel"},[s._v("=")]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}})]),t("span",{staticClass:"base"},[t("span",{staticClass:"strut",staticStyle:{height:"3.1304em","vertical-align":"-1.3021em"}}),t("span",{staticClass:"mop op-limits"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.6944em"}},[t("span",{staticStyle:{top:"-2.3557em","margin-left":"0em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.10903em"}},[s._v("N")]),t("span",{staticClass:"mrel mtight"},[s._v("→")]),t("span",{staticClass:"mord mtight"},[s._v("∞")])])])]),t("span",{staticStyle:{top:"-3em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),t("span",[t("span",{staticClass:"mop"},[s._v("lim")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.7443em"}},[t("span")])])])]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.1667em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mopen nulldelimiter"}),t("span",{staticClass:"mfrac"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"1.3214em"}},[t("span",{staticStyle:{top:"-2.314em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.10903em"}},[s._v("N")])])]),t("span",{staticStyle:{top:"-3.23em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),t("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),t("span",{staticStyle:{top:"-3.677em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord"},[s._v("1")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.686em"}},[t("span")])])])]),t("span",{staticClass:"mclose nulldelimiter"})]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.1667em"}}),t("span",{staticClass:"mop op-limits"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"1.8283em"}},[t("span",{staticStyle:{top:"-1.8479em","margin-left":"0em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3.05em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.03148em"}},[s._v("k")]),t("span",{staticClass:"mrel mtight"},[s._v("=")]),t("span",{staticClass:"mord mtight"},[s._v("1")])])])]),t("span",{staticStyle:{top:"-3.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3.05em"}}),t("span",[t("span",{staticClass:"mop op-symbol large-op"},[s._v("∑")])])]),t("span",{staticStyle:{top:"-4.3em","margin-left":"0em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3.05em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.10903em"}},[s._v("N")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"1.3021em"}},[t("span")])])])]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.1667em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mopen nulldelimiter"}),t("span",{staticClass:"mfrac"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"1.427em"}},[t("span",{staticStyle:{top:"-2.314em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal"},[s._v("p")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3361em"}},[t("span",{staticStyle:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.03148em"}},[s._v("k")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[t("span")])])])])])])]),t("span",{staticStyle:{top:"-3.23em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),t("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),t("span",{staticStyle:{top:"-3.677em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.10764em"}},[s._v("f")]),t("span",{staticClass:"mopen"},[s._v("(")]),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal"},[s._v("x")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3361em"}},[t("span",{staticStyle:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.03148em"}},[s._v("k")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[t("span")])])])])]),t("span",{staticClass:"mclose"},[s._v(")")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.8804em"}},[t("span")])])])]),t("span",{staticClass:"mclose nulldelimiter"})])])])])])])],1),t("p",[s._v("在这个式子中，$ f(x_k) $ 代表该像素的BRDF，$ p_k $ 代表PDF。可以发现积分结果的差异主要来自于BRDF。")]),s._v(" "),t("p",[s._v("既然如此，回到问题的最初，反射是在解决一个什么样的问题？")]),s._v(" "),t("p",[s._v("人眼通过反射看到一个物体，就意味着物体发射了无数条光线进入人眼，进入人眼的光线可以看作是这无数条反射光线进行积分后的总和。于是有了如下这个能量守恒的式子。")]),s._v(" "),t("section",[t("eqn",[t("span",{staticClass:"katex-display"},[t("span",{staticClass:"katex"},[t("span",{staticClass:"katex-mathml"},[t("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}},[t("semantics",[t("mrow",[t("msub",[t("mi",[s._v("L")]),t("mi",[s._v("o")])],1),t("mo",[s._v("=")]),t("mo",[s._v("∫")]),t("msub",[t("mi",[s._v("L")]),t("mi",[s._v("i")])],1),t("mo",{attrs:{stretchy:"false"}},[s._v("(")]),t("mi",[s._v("l")]),t("mo",{attrs:{stretchy:"false"}},[s._v(")")]),t("msub",[t("mi",[s._v("f")]),t("mi",[s._v("s")])],1),t("mo",{attrs:{stretchy:"false"}},[s._v("(")]),t("mi",[s._v("l")]),t("mo",[s._v("→")]),t("mi",[s._v("v")]),t("mo",{attrs:{stretchy:"false"}},[s._v(")")]),t("mi",[s._v("c")]),t("mi",[s._v("o")]),t("mi",[s._v("s")]),t("msub",[t("mi",[s._v("θ")]),t("mi",[s._v("l")])],1),t("mi",[s._v("d")]),t("mi",[s._v("l")])],1),t("annotation",{attrs:{encoding:"application/x-tex"}},[s._v(" L_o = \\int L_i(l)f_s(l\\rightarrow v)cos\\theta_ldl ")])],1)],1)],1),t("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[t("span",{staticClass:"base"},[t("span",{staticClass:"strut",staticStyle:{height:"0.8333em","vertical-align":"-0.15em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal"},[s._v("L")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.1514em"}},[t("span",{staticStyle:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight"},[s._v("o")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[t("span")])])])])]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}}),t("span",{staticClass:"mrel"},[s._v("=")]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}})]),t("span",{staticClass:"base"},[t("span",{staticClass:"strut",staticStyle:{height:"2.2222em","vertical-align":"-0.8622em"}}),t("span",{staticClass:"mop op-symbol large-op",staticStyle:{"margin-right":"0.44445em",position:"relative",top:"-0.0011em"}},[s._v("∫")]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.1667em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal"},[s._v("L")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3117em"}},[t("span",{staticStyle:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight"},[s._v("i")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[t("span")])])])])]),t("span",{staticClass:"mopen"},[s._v("(")]),t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")]),t("span",{staticClass:"mclose"},[s._v(")")]),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.10764em"}},[s._v("f")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.1514em"}},[t("span",{staticStyle:{top:"-2.55em","margin-left":"-0.1076em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight"},[s._v("s")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[t("span")])])])])]),t("span",{staticClass:"mopen"},[s._v("(")]),t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}}),t("span",{staticClass:"mrel"},[s._v("→")]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}})]),t("span",{staticClass:"base"},[t("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.03588em"}},[s._v("v")]),t("span",{staticClass:"mclose"},[s._v(")")]),t("span",{staticClass:"mord mathnormal"},[s._v("cos")]),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3361em"}},[t("span",{staticStyle:{top:"-2.55em","margin-left":"-0.0278em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[t("span")])])])])]),t("span",{staticClass:"mord mathnormal"},[s._v("d")]),t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")])])])])])])],1),t("p",[s._v("其中 $ L_i $ 代表入射辐射率，$ f_s $ 代表BRDF。通过重要性采样之后，该式子可以写成蒙特卡洛积分的形式")]),s._v(" "),t("section",[t("eqn",[t("span",{staticClass:"katex-display"},[t("span",{staticClass:"katex"},[t("span",{staticClass:"katex-mathml"},[t("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}},[t("semantics",[t("mrow",[t("msub",[t("mi",[s._v("L")]),t("mi",[s._v("o")])],1),t("mo",[s._v("=")]),t("munder",[t("mrow",[t("mi",[s._v("lim")]),t("mo",[s._v("⁡")])],1),t("mrow",[t("mi",[s._v("N")]),t("mo",[s._v("→")]),t("mi",{attrs:{mathvariant:"normal"}},[s._v("∞")])],1)],1),t("mfrac",[t("mn",[s._v("1")]),t("mi",[s._v("N")])],1),t("munderover",[t("mo",[s._v("∑")]),t("mrow",[t("mi",[s._v("k")]),t("mo",[s._v("=")]),t("mn",[s._v("1")])],1),t("mi",[s._v("N")])],1),t("mfrac",[t("mrow",[t("msub",[t("mi",[s._v("L")]),t("mi",[s._v("i")])],1),t("mo",{attrs:{stretchy:"false"}},[s._v("(")]),t("msub",[t("mi",[s._v("l")]),t("mi",[s._v("k")])],1),t("mo",{attrs:{stretchy:"false"}},[s._v(")")]),t("msub",[t("mi",[s._v("f")]),t("mi",[s._v("s")])],1),t("mo",{attrs:{stretchy:"false"}},[s._v("(")]),t("msub",[t("mi",[s._v("l")]),t("mi",[s._v("k")])],1),t("mo",[s._v("→")]),t("mi",[s._v("v")]),t("mo",{attrs:{stretchy:"false"}},[s._v(")")]),t("mi",[s._v("c")]),t("mi",[s._v("o")]),t("mi",[s._v("s")]),t("msub",[t("mi",[s._v("θ")]),t("msub",[t("mi",[s._v("l")]),t("mi",[s._v("k")])],1)],1)],1),t("msub",[t("mi",[s._v("p")]),t("mi",[s._v("k")])],1)],1)],1),t("annotation",{attrs:{encoding:"application/x-tex"}},[s._v(" L_o = \\lim_{N\\rightarrow\\infty}\\frac{1}{N}\\sum^N_{k=1}\\frac{L_i(l_k)f_s(l_k\\rightarrow v)cos\\theta_{l_k}}{p_k} ")])],1)],1)],1),t("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[t("span",{staticClass:"base"},[t("span",{staticClass:"strut",staticStyle:{height:"0.8333em","vertical-align":"-0.15em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal"},[s._v("L")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.1514em"}},[t("span",{staticStyle:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight"},[s._v("o")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[t("span")])])])])]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}}),t("span",{staticClass:"mrel"},[s._v("=")]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}})]),t("span",{staticClass:"base"},[t("span",{staticClass:"strut",staticStyle:{height:"3.1304em","vertical-align":"-1.3021em"}}),t("span",{staticClass:"mop op-limits"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.6944em"}},[t("span",{staticStyle:{top:"-2.3557em","margin-left":"0em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.10903em"}},[s._v("N")]),t("span",{staticClass:"mrel mtight"},[s._v("→")]),t("span",{staticClass:"mord mtight"},[s._v("∞")])])])]),t("span",{staticStyle:{top:"-3em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),t("span",[t("span",{staticClass:"mop"},[s._v("lim")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.7443em"}},[t("span")])])])]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.1667em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mopen nulldelimiter"}),t("span",{staticClass:"mfrac"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"1.3214em"}},[t("span",{staticStyle:{top:"-2.314em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.10903em"}},[s._v("N")])])]),t("span",{staticStyle:{top:"-3.23em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),t("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),t("span",{staticStyle:{top:"-3.677em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord"},[s._v("1")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.686em"}},[t("span")])])])]),t("span",{staticClass:"mclose nulldelimiter"})]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.1667em"}}),t("span",{staticClass:"mop op-limits"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"1.8283em"}},[t("span",{staticStyle:{top:"-1.8479em","margin-left":"0em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3.05em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.03148em"}},[s._v("k")]),t("span",{staticClass:"mrel mtight"},[s._v("=")]),t("span",{staticClass:"mord mtight"},[s._v("1")])])])]),t("span",{staticStyle:{top:"-3.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3.05em"}}),t("span",[t("span",{staticClass:"mop op-symbol large-op"},[s._v("∑")])])]),t("span",{staticStyle:{top:"-4.3em","margin-left":"0em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3.05em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.10903em"}},[s._v("N")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"1.3021em"}},[t("span")])])])]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.1667em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mopen nulldelimiter"}),t("span",{staticClass:"mfrac"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"1.427em"}},[t("span",{staticStyle:{top:"-2.314em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal"},[s._v("p")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3361em"}},[t("span",{staticStyle:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.03148em"}},[s._v("k")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[t("span")])])])])])])]),t("span",{staticStyle:{top:"-3.23em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),t("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),t("span",{staticStyle:{top:"-3.677em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal"},[s._v("L")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3117em"}},[t("span",{staticStyle:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight"},[s._v("i")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[t("span")])])])])]),t("span",{staticClass:"mopen"},[s._v("(")]),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3361em"}},[t("span",{staticStyle:{top:"-2.55em","margin-left":"-0.0197em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.03148em"}},[s._v("k")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[t("span")])])])])]),t("span",{staticClass:"mclose"},[s._v(")")]),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.10764em"}},[s._v("f")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.1514em"}},[t("span",{staticStyle:{top:"-2.55em","margin-left":"-0.1076em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight"},[s._v("s")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[t("span")])])])])]),t("span",{staticClass:"mopen"},[s._v("(")]),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3361em"}},[t("span",{staticStyle:{top:"-2.55em","margin-left":"-0.0197em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.03148em"}},[s._v("k")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[t("span")])])])])]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}}),t("span",{staticClass:"mrel"},[s._v("→")]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}}),t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.03588em"}},[s._v("v")]),t("span",{staticClass:"mclose"},[s._v(")")]),t("span",{staticClass:"mord mathnormal"},[s._v("cos")]),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3361em"}},[t("span",{staticStyle:{top:"-2.55em","margin-left":"-0.0278em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mtight"},[t("span",{staticClass:"mord mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3448em"}},[t("span",{staticStyle:{top:"-2.3488em","margin-left":"-0.0197em","margin-right":"0.0714em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.5em"}}),t("span",{staticClass:"sizing reset-size3 size1 mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.03148em"}},[s._v("k")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.1512em"}},[t("span")])])])])])])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.2559em"}},[t("span")])])])])])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.8804em"}},[t("span")])])])]),t("span",{staticClass:"mclose nulldelimiter"})])])])])])])],1),t("p",[s._v("可见该式子的方差，主要来自于这一部分")]),s._v(" "),t("section",[t("eqn",[t("span",{staticClass:"katex-display"},[t("span",{staticClass:"katex"},[t("span",{staticClass:"katex-mathml"},[t("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}},[t("semantics",[t("mrow",[t("mfrac",[t("mrow",[t("msub",[t("mi",[s._v("f")]),t("mi",[s._v("s")])],1),t("mo",{attrs:{stretchy:"false"}},[s._v("(")]),t("msub",[t("mi",[s._v("l")]),t("mi",[s._v("k")])],1),t("mo",[s._v("→")]),t("mi",[s._v("v")]),t("mo",{attrs:{stretchy:"false"}},[s._v(")")]),t("mi",[s._v("c")]),t("mi",[s._v("o")]),t("mi",[s._v("s")]),t("msub",[t("mi",[s._v("θ")]),t("msub",[t("mi",[s._v("l")]),t("mi",[s._v("k")])],1)],1)],1),t("msub",[t("mi",[s._v("p")]),t("mi",[s._v("k")])],1)],1)],1),t("annotation",{attrs:{encoding:"application/x-tex"}},[s._v(" \\frac{f_s(l_k\\rightarrow v)cos\\theta_{l_k}}{p_k} ")])],1)],1)],1),t("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[t("span",{staticClass:"base"},[t("span",{staticClass:"strut",staticStyle:{height:"2.3074em","vertical-align":"-0.8804em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mopen nulldelimiter"}),t("span",{staticClass:"mfrac"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"1.427em"}},[t("span",{staticStyle:{top:"-2.314em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal"},[s._v("p")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3361em"}},[t("span",{staticStyle:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.03148em"}},[s._v("k")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[t("span")])])])])])])]),t("span",{staticStyle:{top:"-3.23em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),t("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),t("span",{staticStyle:{top:"-3.677em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.10764em"}},[s._v("f")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.1514em"}},[t("span",{staticStyle:{top:"-2.55em","margin-left":"-0.1076em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight"},[s._v("s")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[t("span")])])])])]),t("span",{staticClass:"mopen"},[s._v("(")]),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3361em"}},[t("span",{staticStyle:{top:"-2.55em","margin-left":"-0.0197em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.03148em"}},[s._v("k")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[t("span")])])])])]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}}),t("span",{staticClass:"mrel"},[s._v("→")]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}}),t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.03588em"}},[s._v("v")]),t("span",{staticClass:"mclose"},[s._v(")")]),t("span",{staticClass:"mord mathnormal"},[s._v("cos")]),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3361em"}},[t("span",{staticStyle:{top:"-2.55em","margin-left":"-0.0278em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mtight"},[t("span",{staticClass:"mord mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3448em"}},[t("span",{staticStyle:{top:"-2.3488em","margin-left":"-0.0197em","margin-right":"0.0714em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.5em"}}),t("span",{staticClass:"sizing reset-size3 size1 mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.03148em"}},[s._v("k")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.1512em"}},[t("span")])])])])])])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.2559em"}},[t("span")])])])])])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.8804em"}},[t("span")])])])]),t("span",{staticClass:"mclose nulldelimiter"})])])])])])])],1),t("p",[s._v("在上述不定积分的式子中同除同乘带来方差的项可得")]),s._v(" "),t("section",[t("eqn",[t("span",{staticClass:"katex-display"},[t("span",{staticClass:"katex"},[t("span",{staticClass:"katex-mathml"},[t("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}},[t("semantics",[t("mrow",[t("msub",[t("mi",[s._v("L")]),t("mi",[s._v("o")])],1),t("mo",[s._v("=")]),t("mfrac",[t("mrow",[t("mo",[s._v("∫")]),t("msub",[t("mi",[s._v("L")]),t("mi",[s._v("i")])],1),t("mo",{attrs:{stretchy:"false"}},[s._v("(")]),t("mi",[s._v("l")]),t("mo",{attrs:{stretchy:"false"}},[s._v(")")]),t("msub",[t("mi",[s._v("f")]),t("mi",[s._v("s")])],1),t("mo",{attrs:{stretchy:"false"}},[s._v("(")]),t("mi",[s._v("l")]),t("mo",[s._v("→")]),t("mi",[s._v("v")]),t("mo",{attrs:{stretchy:"false"}},[s._v(")")]),t("mi",[s._v("c")]),t("mi",[s._v("o")]),t("mi",[s._v("s")]),t("msub",[t("mi",[s._v("θ")]),t("mi",[s._v("l")])],1),t("mi",[s._v("d")]),t("mi",[s._v("l")])],1),t("mrow",[t("mo",[s._v("∫")]),t("msub",[t("mi",[s._v("f")]),t("mi",[s._v("s")])],1),t("mo",{attrs:{stretchy:"false"}},[s._v("(")]),t("mi",[s._v("l")]),t("mo",[s._v("→")]),t("mi",[s._v("v")]),t("mo",{attrs:{stretchy:"false"}},[s._v(")")]),t("mi",[s._v("c")]),t("mi",[s._v("o")]),t("mi",[s._v("s")]),t("msub",[t("mi",[s._v("θ")]),t("mi",[s._v("l")])],1),t("mi",[s._v("d")]),t("mi",[s._v("l")])],1)],1),t("mo",[s._v("∫")]),t("msub",[t("mi",[s._v("f")]),t("mi",[s._v("s")])],1),t("mo",{attrs:{stretchy:"false"}},[s._v("(")]),t("mi",[s._v("l")]),t("mo",[s._v("→")]),t("mi",[s._v("v")]),t("mo",{attrs:{stretchy:"false"}},[s._v(")")]),t("mi",[s._v("c")]),t("mi",[s._v("o")]),t("mi",[s._v("s")]),t("msub",[t("mi",[s._v("θ")]),t("mi",[s._v("l")])],1),t("mi",[s._v("d")]),t("mi",[s._v("l")])],1),t("annotation",{attrs:{encoding:"application/x-tex"}},[s._v(" L_o = \\frac{\\int L_i(l)f_s(l\\rightarrow v)cos\\theta_ldl}{\\int f_s(l\\rightarrow v)cos\\theta_ldl}\\int f_s(l\\rightarrow v)cos\\theta_ldl ")])],1)],1)],1),t("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[t("span",{staticClass:"base"},[t("span",{staticClass:"strut",staticStyle:{height:"0.8333em","vertical-align":"-0.15em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal"},[s._v("L")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.1514em"}},[t("span",{staticStyle:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight"},[s._v("o")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[t("span")])])])])]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}}),t("span",{staticClass:"mrel"},[s._v("=")]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}})]),t("span",{staticClass:"base"},[t("span",{staticClass:"strut",staticStyle:{height:"2.5022em","vertical-align":"-1.0011em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mopen nulldelimiter"}),t("span",{staticClass:"mfrac"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"1.5011em"}},[t("span",{staticStyle:{top:"-2.305em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mop op-symbol small-op",staticStyle:{"margin-right":"0.19445em",position:"relative",top:"-0.0006em"}},[s._v("∫")]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.1667em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.10764em"}},[s._v("f")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.1514em"}},[t("span",{staticStyle:{top:"-2.55em","margin-left":"-0.1076em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight"},[s._v("s")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[t("span")])])])])]),t("span",{staticClass:"mopen"},[s._v("(")]),t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}}),t("span",{staticClass:"mrel"},[s._v("→")]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}}),t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.03588em"}},[s._v("v")]),t("span",{staticClass:"mclose"},[s._v(")")]),t("span",{staticClass:"mord mathnormal"},[s._v("cos")]),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3361em"}},[t("span",{staticStyle:{top:"-2.55em","margin-left":"-0.0278em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[t("span")])])])])]),t("span",{staticClass:"mord mathnormal"},[s._v("d")]),t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")])])]),t("span",{staticStyle:{top:"-3.23em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),t("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),t("span",{staticStyle:{top:"-3.6961em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mop op-symbol small-op",staticStyle:{"margin-right":"0.19445em",position:"relative",top:"-0.0006em"}},[s._v("∫")]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.1667em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal"},[s._v("L")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3117em"}},[t("span",{staticStyle:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight"},[s._v("i")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[t("span")])])])])]),t("span",{staticClass:"mopen"},[s._v("(")]),t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")]),t("span",{staticClass:"mclose"},[s._v(")")]),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.10764em"}},[s._v("f")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.1514em"}},[t("span",{staticStyle:{top:"-2.55em","margin-left":"-0.1076em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight"},[s._v("s")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[t("span")])])])])]),t("span",{staticClass:"mopen"},[s._v("(")]),t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}}),t("span",{staticClass:"mrel"},[s._v("→")]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}}),t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.03588em"}},[s._v("v")]),t("span",{staticClass:"mclose"},[s._v(")")]),t("span",{staticClass:"mord mathnormal"},[s._v("cos")]),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3361em"}},[t("span",{staticStyle:{top:"-2.55em","margin-left":"-0.0278em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[t("span")])])])])]),t("span",{staticClass:"mord mathnormal"},[s._v("d")]),t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"1.0011em"}},[t("span")])])])]),t("span",{staticClass:"mclose nulldelimiter"})]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.1667em"}}),t("span",{staticClass:"mop op-symbol large-op",staticStyle:{"margin-right":"0.44445em",position:"relative",top:"-0.0011em"}},[s._v("∫")]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.1667em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.10764em"}},[s._v("f")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.1514em"}},[t("span",{staticStyle:{top:"-2.55em","margin-left":"-0.1076em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight"},[s._v("s")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[t("span")])])])])]),t("span",{staticClass:"mopen"},[s._v("(")]),t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}}),t("span",{staticClass:"mrel"},[s._v("→")]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}})]),t("span",{staticClass:"base"},[t("span",{staticClass:"strut",staticStyle:{height:"1em","vertical-align":"-0.25em"}}),t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.03588em"}},[s._v("v")]),t("span",{staticClass:"mclose"},[s._v(")")]),t("span",{staticClass:"mord mathnormal"},[s._v("cos")]),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3361em"}},[t("span",{staticStyle:{top:"-2.55em","margin-left":"-0.0278em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[t("span")])])])])]),t("span",{staticClass:"mord mathnormal"},[s._v("d")]),t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")])])])])])])],1),t("p",[s._v("可以发现，同乘除的这一项的物理意义可以理解为反射BRDF的积分，又可近似看作是IBL中的反射项，因此该式子可以写成")]),s._v(" "),t("section",[t("eqn",[t("span",{staticClass:"katex-display"},[t("span",{staticClass:"katex"},[t("span",{staticClass:"katex-mathml"},[t("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}},[t("semantics",[t("mrow",[t("msub",[t("mi",[s._v("L")]),t("mi",[s._v("o")])],1),t("mo",[s._v("≈")]),t("mfrac",[t("mrow",[t("mo",[s._v("∫")]),t("msub",[t("mi",[s._v("L")]),t("mi",[s._v("i")])],1),t("mo",{attrs:{stretchy:"false"}},[s._v("(")]),t("mi",[s._v("l")]),t("mo",{attrs:{stretchy:"false"}},[s._v(")")]),t("msub",[t("mi",[s._v("f")]),t("mi",[s._v("s")])],1),t("mo",{attrs:{stretchy:"false"}},[s._v("(")]),t("mi",[s._v("l")]),t("mo",[s._v("→")]),t("mi",[s._v("v")]),t("mo",{attrs:{stretchy:"false"}},[s._v(")")]),t("mi",[s._v("c")]),t("mi",[s._v("o")]),t("mi",[s._v("s")]),t("msub",[t("mi",[s._v("θ")]),t("mi",[s._v("l")])],1),t("mi",[s._v("d")]),t("mi",[s._v("l")])],1),t("mrow",[t("mo",[s._v("∫")]),t("msub",[t("mi",[s._v("f")]),t("mi",[s._v("s")])],1),t("mo",{attrs:{stretchy:"false"}},[s._v("(")]),t("mi",[s._v("l")]),t("mo",[s._v("→")]),t("mi",[s._v("v")]),t("mo",{attrs:{stretchy:"false"}},[s._v(")")]),t("mi",[s._v("c")]),t("mi",[s._v("o")]),t("mi",[s._v("s")]),t("msub",[t("mi",[s._v("θ")]),t("mi",[s._v("l")])],1),t("mi",[s._v("d")]),t("mi",[s._v("l")])],1)],1),t("mi",[s._v("F")]),t("mi",[s._v("G")])],1),t("annotation",{attrs:{encoding:"application/x-tex"}},[s._v(" L_o \\approx \\frac{\\int L_i(l)f_s(l\\rightarrow v)cos\\theta_ldl}{\\int f_s(l\\rightarrow v)cos\\theta_ldl}FG ")])],1)],1)],1),t("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[t("span",{staticClass:"base"},[t("span",{staticClass:"strut",staticStyle:{height:"0.8333em","vertical-align":"-0.15em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal"},[s._v("L")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.1514em"}},[t("span",{staticStyle:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight"},[s._v("o")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[t("span")])])])])]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}}),t("span",{staticClass:"mrel"},[s._v("≈")]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}})]),t("span",{staticClass:"base"},[t("span",{staticClass:"strut",staticStyle:{height:"2.5022em","vertical-align":"-1.0011em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mopen nulldelimiter"}),t("span",{staticClass:"mfrac"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"1.5011em"}},[t("span",{staticStyle:{top:"-2.305em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mop op-symbol small-op",staticStyle:{"margin-right":"0.19445em",position:"relative",top:"-0.0006em"}},[s._v("∫")]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.1667em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.10764em"}},[s._v("f")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.1514em"}},[t("span",{staticStyle:{top:"-2.55em","margin-left":"-0.1076em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight"},[s._v("s")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[t("span")])])])])]),t("span",{staticClass:"mopen"},[s._v("(")]),t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}}),t("span",{staticClass:"mrel"},[s._v("→")]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}}),t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.03588em"}},[s._v("v")]),t("span",{staticClass:"mclose"},[s._v(")")]),t("span",{staticClass:"mord mathnormal"},[s._v("cos")]),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3361em"}},[t("span",{staticStyle:{top:"-2.55em","margin-left":"-0.0278em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[t("span")])])])])]),t("span",{staticClass:"mord mathnormal"},[s._v("d")]),t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")])])]),t("span",{staticStyle:{top:"-3.23em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),t("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),t("span",{staticStyle:{top:"-3.6961em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mop op-symbol small-op",staticStyle:{"margin-right":"0.19445em",position:"relative",top:"-0.0006em"}},[s._v("∫")]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.1667em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal"},[s._v("L")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3117em"}},[t("span",{staticStyle:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight"},[s._v("i")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[t("span")])])])])]),t("span",{staticClass:"mopen"},[s._v("(")]),t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")]),t("span",{staticClass:"mclose"},[s._v(")")]),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.10764em"}},[s._v("f")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.1514em"}},[t("span",{staticStyle:{top:"-2.55em","margin-left":"-0.1076em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight"},[s._v("s")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[t("span")])])])])]),t("span",{staticClass:"mopen"},[s._v("(")]),t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}}),t("span",{staticClass:"mrel"},[s._v("→")]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}}),t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.03588em"}},[s._v("v")]),t("span",{staticClass:"mclose"},[s._v(")")]),t("span",{staticClass:"mord mathnormal"},[s._v("cos")]),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3361em"}},[t("span",{staticStyle:{top:"-2.55em","margin-left":"-0.0278em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[t("span")])])])])]),t("span",{staticClass:"mord mathnormal"},[s._v("d")]),t("span",{staticClass:"mord mathnormal",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"1.0011em"}},[t("span")])])])]),t("span",{staticClass:"mclose nulldelimiter"})]),t("span",{staticClass:"mord mathnormal"},[s._v("FG")])])])])])])],1),t("p",[s._v("再写成蒙特卡洛积分形式")]),s._v(" "),t("section",[t("eqn",[t("span",{staticClass:"katex-display"},[t("span",{staticClass:"katex"},[t("span",{staticClass:"katex-mathml"},[t("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"}},[t("semantics",[t("mrow",[t("msub",[t("mi",[s._v("L")]),t("mi",[s._v("o")])],1),t("mo",[s._v("≈")]),t("mfrac",[t("mrow",[t("munderover",[t("mo",[s._v("∑")]),t("mrow",[t("mi",[s._v("k")]),t("mo",[s._v("=")]),t("mn",[s._v("1")])],1),t("mi",[s._v("N")])],1),t("mfrac",[t("mrow",[t("msub",[t("mi",[s._v("L")]),t("mi",[s._v("i")])],1),t("mo",{attrs:{stretchy:"false"}},[s._v("(")]),t("msub",[t("mi",[s._v("l")]),t("mi",[s._v("k")])],1),t("mo",{attrs:{stretchy:"false"}},[s._v(")")]),t("msub",[t("mi",[s._v("f")]),t("mi",[s._v("s")])],1),t("mo",{attrs:{stretchy:"false"}},[s._v("(")]),t("msub",[t("mi",[s._v("l")]),t("mi",[s._v("k")])],1),t("mo",[s._v("→")]),t("mi",[s._v("v")]),t("mo",{attrs:{stretchy:"false"}},[s._v(")")]),t("mi",[s._v("c")]),t("mi",[s._v("o")]),t("mi",[s._v("s")]),t("msub",[t("mi",[s._v("θ")]),t("msub",[t("mi",[s._v("l")]),t("mi",[s._v("k")])],1)],1)],1),t("msub",[t("mi",[s._v("p")]),t("mi",[s._v("k")])],1)],1)],1),t("mrow",[t("munderover",[t("mo",[s._v("∑")]),t("mrow",[t("mi",[s._v("k")]),t("mo",[s._v("=")]),t("mn",[s._v("1")])],1),t("mi",[s._v("N")])],1),t("mfrac",[t("mrow",[t("msub",[t("mi",[s._v("f")]),t("mi",[s._v("s")])],1),t("mo",{attrs:{stretchy:"false"}},[s._v("(")]),t("msub",[t("mi",[s._v("l")]),t("mi",[s._v("k")])],1),t("mo",[s._v("→")]),t("mi",[s._v("v")]),t("mo",{attrs:{stretchy:"false"}},[s._v(")")]),t("mi",[s._v("c")]),t("mi",[s._v("o")]),t("mi",[s._v("s")]),t("msub",[t("mi",[s._v("θ")]),t("msub",[t("mi",[s._v("l")]),t("mi",[s._v("k")])],1)],1)],1),t("msub",[t("mi",[s._v("p")]),t("mi",[s._v("k")])],1)],1)],1)],1),t("mi",[s._v("F")]),t("mi",[s._v("G")])],1),t("annotation",{attrs:{encoding:"application/x-tex"}},[s._v(" L_o \\approx \\frac{\\sum^N_{k=1}\\frac{L_i(l_k)f_s(l_k\\rightarrow v)cos\\theta_{l_k}}{p_k}}{\\sum^N_{k=1}\\frac{f_s(l_k\\rightarrow v)cos\\theta_{l_k}}{p_k}}FG ")])],1)],1)],1),t("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[t("span",{staticClass:"base"},[t("span",{staticClass:"strut",staticStyle:{height:"0.8333em","vertical-align":"-0.15em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mord mathnormal"},[s._v("L")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.1514em"}},[t("span",{staticStyle:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight"},[s._v("o")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.15em"}},[t("span")])])])])]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}}),t("span",{staticClass:"mrel"},[s._v("≈")]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2778em"}})]),t("span",{staticClass:"base"},[t("span",{staticClass:"strut",staticStyle:{height:"3.4736em","vertical-align":"-1.4868em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mopen nulldelimiter"}),t("span",{staticClass:"mfrac"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"1.9868em"}},[t("span",{staticStyle:{top:"-2.11em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3.1157em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mop"},[t("span",{staticClass:"mop op-symbol small-op",staticStyle:{position:"relative",top:"0em"}},[s._v("∑")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.9812em"}},[t("span",{staticStyle:{top:"-2.4003em","margin-left":"0em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.03148em"}},[s._v("k")]),t("span",{staticClass:"mrel mtight"},[s._v("=")]),t("span",{staticClass:"mord mtight"},[s._v("1")])])])]),t("span",{staticStyle:{top:"-3.2029em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.10903em"}},[s._v("N")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.2997em"}},[t("span")])])])])]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.1667em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mopen nulldelimiter"}),t("span",{staticClass:"mfrac"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"1.1157em"}},[t("span",{staticStyle:{top:"-2.655em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mtight"},[t("span",{staticClass:"mord mtight"},[t("span",{staticClass:"mord mathnormal mtight"},[s._v("p")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3448em"}},[t("span",{staticStyle:{top:"-2.3488em","margin-left":"0em","margin-right":"0.0714em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.5em"}}),t("span",{staticClass:"sizing reset-size3 size1 mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.03148em"}},[s._v("k")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.1512em"}},[t("span")])])])])])])])]),t("span",{staticStyle:{top:"-3.23em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),t("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),t("span",{staticStyle:{top:"-3.5907em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mtight"},[t("span",{staticClass:"mord mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.10764em"}},[s._v("f")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.1645em"}},[t("span",{staticStyle:{top:"-2.357em","margin-left":"-0.1076em","margin-right":"0.0714em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.5em"}}),t("span",{staticClass:"sizing reset-size3 size1 mtight"},[t("span",{staticClass:"mord mathnormal mtight"},[s._v("s")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.143em"}},[t("span")])])])])]),t("span",{staticClass:"mopen mtight"},[s._v("(")]),t("span",{staticClass:"mord mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3448em"}},[t("span",{staticStyle:{top:"-2.3488em","margin-left":"-0.0197em","margin-right":"0.0714em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.5em"}}),t("span",{staticClass:"sizing reset-size3 size1 mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.03148em"}},[s._v("k")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.1512em"}},[t("span")])])])])]),t("span",{staticClass:"mrel mtight"},[s._v("→")]),t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.03588em"}},[s._v("v")]),t("span",{staticClass:"mclose mtight"},[s._v(")")]),t("span",{staticClass:"mord mathnormal mtight"},[s._v("cos")]),t("span",{staticClass:"mord mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3448em"}},[t("span",{staticStyle:{top:"-2.3488em","margin-left":"-0.0278em","margin-right":"0.0714em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.5em"}}),t("span",{staticClass:"sizing reset-size3 size1 mtight"},[t("span",{staticClass:"mord mtight"},[t("span",{staticClass:"mord mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3448em"}},[t("span",{staticStyle:{top:"-2.3448em","margin-left":"-0.0197em","margin-right":"0.1em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.6944em"}}),t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.03148em"}},[s._v("k")])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3496em"}},[t("span")])])])])])])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.401em"}},[t("span")])])])])])])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.4811em"}},[t("span")])])])]),t("span",{staticClass:"mclose nulldelimiter"})])])]),t("span",{staticStyle:{top:"-3.3457em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3.1157em"}}),t("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),t("span",{staticStyle:{top:"-3.9868em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3.1157em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mop"},[t("span",{staticClass:"mop op-symbol small-op",staticStyle:{position:"relative",top:"0em"}},[s._v("∑")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.9812em"}},[t("span",{staticStyle:{top:"-2.4003em","margin-left":"0em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.03148em"}},[s._v("k")]),t("span",{staticClass:"mrel mtight"},[s._v("=")]),t("span",{staticClass:"mord mtight"},[s._v("1")])])])]),t("span",{staticStyle:{top:"-3.2029em","margin-right":"0.05em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.10903em"}},[s._v("N")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.2997em"}},[t("span")])])])])]),t("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.1667em"}}),t("span",{staticClass:"mord"},[t("span",{staticClass:"mopen nulldelimiter"}),t("span",{staticClass:"mfrac"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"1.1157em"}},[t("span",{staticStyle:{top:"-2.655em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mtight"},[t("span",{staticClass:"mord mtight"},[t("span",{staticClass:"mord mathnormal mtight"},[s._v("p")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3448em"}},[t("span",{staticStyle:{top:"-2.3488em","margin-left":"0em","margin-right":"0.0714em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.5em"}}),t("span",{staticClass:"sizing reset-size3 size1 mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.03148em"}},[s._v("k")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.1512em"}},[t("span")])])])])])])])]),t("span",{staticStyle:{top:"-3.23em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),t("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),t("span",{staticStyle:{top:"-3.5907em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),t("span",{staticClass:"sizing reset-size6 size3 mtight"},[t("span",{staticClass:"mord mtight"},[t("span",{staticClass:"mord mtight"},[t("span",{staticClass:"mord mathnormal mtight"},[s._v("L")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3281em"}},[t("span",{staticStyle:{top:"-2.357em","margin-left":"0em","margin-right":"0.0714em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.5em"}}),t("span",{staticClass:"sizing reset-size3 size1 mtight"},[t("span",{staticClass:"mord mathnormal mtight"},[s._v("i")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.143em"}},[t("span")])])])])]),t("span",{staticClass:"mopen mtight"},[s._v("(")]),t("span",{staticClass:"mord mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3448em"}},[t("span",{staticStyle:{top:"-2.3488em","margin-left":"-0.0197em","margin-right":"0.0714em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.5em"}}),t("span",{staticClass:"sizing reset-size3 size1 mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.03148em"}},[s._v("k")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.1512em"}},[t("span")])])])])]),t("span",{staticClass:"mclose mtight"},[s._v(")")]),t("span",{staticClass:"mord mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.10764em"}},[s._v("f")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.1645em"}},[t("span",{staticStyle:{top:"-2.357em","margin-left":"-0.1076em","margin-right":"0.0714em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.5em"}}),t("span",{staticClass:"sizing reset-size3 size1 mtight"},[t("span",{staticClass:"mord mathnormal mtight"},[s._v("s")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.143em"}},[t("span")])])])])]),t("span",{staticClass:"mopen mtight"},[s._v("(")]),t("span",{staticClass:"mord mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3448em"}},[t("span",{staticStyle:{top:"-2.3488em","margin-left":"-0.0197em","margin-right":"0.0714em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.5em"}}),t("span",{staticClass:"sizing reset-size3 size1 mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.03148em"}},[s._v("k")])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.1512em"}},[t("span")])])])])]),t("span",{staticClass:"mrel mtight"},[s._v("→")]),t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.03588em"}},[s._v("v")]),t("span",{staticClass:"mclose mtight"},[s._v(")")]),t("span",{staticClass:"mord mathnormal mtight"},[s._v("cos")]),t("span",{staticClass:"mord mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.02778em"}},[s._v("θ")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3448em"}},[t("span",{staticStyle:{top:"-2.3488em","margin-left":"-0.0278em","margin-right":"0.0714em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.5em"}}),t("span",{staticClass:"sizing reset-size3 size1 mtight"},[t("span",{staticClass:"mord mtight"},[t("span",{staticClass:"mord mtight"},[t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.01968em"}},[s._v("l")]),t("span",{staticClass:"msupsub"},[t("span",{staticClass:"vlist-t vlist-t2"},[t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3448em"}},[t("span",{staticStyle:{top:"-2.3448em","margin-left":"-0.0197em","margin-right":"0.1em"}},[t("span",{staticClass:"pstrut",staticStyle:{height:"2.6944em"}}),t("span",{staticClass:"mord mathnormal mtight",staticStyle:{"margin-right":"0.03148em"}},[s._v("k")])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.3496em"}},[t("span")])])])])])])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.401em"}},[t("span")])])])])])])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"0.4811em"}},[t("span")])])])]),t("span",{staticClass:"mclose nulldelimiter"})])])])]),t("span",{staticClass:"vlist-s"},[s._v("​")])]),t("span",{staticClass:"vlist-r"},[t("span",{staticClass:"vlist",staticStyle:{height:"1.4868em"}},[t("span")])])])]),t("span",{staticClass:"mclose nulldelimiter"})]),t("span",{staticClass:"mord mathnormal"},[s._v("FG")])])])])])])],1),t("p",[s._v("在这个最终的式子中，分子可以看作是BRDF加权图像的贡献，分子是归一化的BRDF权重，FG则是BRDF的预积分项。这么解释可能比较生硬，还是直接来看伪代码")]),s._v(" "),t("div",{staticClass:"language-cpp line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-cpp"}},[t("code",[s._v("result "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("\nweightSum "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" pixel in neighborhood"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("\n  weight "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("localBRDF")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pixel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hit"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" pixel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hitPDF\n  result "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("color")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("pixel"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("hit"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" weight\n  weightSum "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+=")]),s._v(" weight\nresult "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/=")]),s._v(" weightSum\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h2",{attrs:{id:"优化方案"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#优化方案"}},[s._v("#")]),s._v(" 优化方案")]),s._v(" "),t("p",[s._v("作者在提出算法的同时，也提出了几个优化方案")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("Sparse raytracing")]),s._v(" "),t("p",[s._v("生成RT时使用低分辨率，在发射射线求解时使用全分辨率。能够减少非常多噪点。")])]),s._v(" "),t("li",[t("p",[s._v("Temporal reprojection")]),s._v(" "),t("p",[s._v("将光线投射到上一帧的Depth会产生拖影，因此取平均的Depth来进行计算，在时序上进行光线的复用。")])]),s._v(" "),t("li",[t("p",[s._v("Importance sampling bias")]),s._v(" "),t("p",[s._v("在生成随机数时进行截断，去掉PDF的拖尾，从而减少噪点产生。")])]),s._v(" "),t("li",[t("p",[s._v("Filtered importance sampling")]),s._v(" "),t("p",[s._v("对Color Buffer生成Mip，来模拟Cone Tracing。")])]),s._v(" "),t("li",[t("p",[s._v("Multi-pixel resolve")]),s._v(" "),t("p",[s._v("同时对对条射线进行求解。")])])]),s._v(" "),t("h2",{attrs:{id:"ue5中的ssr实现"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ue5中的ssr实现"}},[s._v("#")]),s._v(" UE5中的SSR实现")]),s._v(" "),t("p",[s._v("UE中的SSR实现主要包含在两个Pass中")]),s._v(" "),t("ol",[t("li",[t("p",[s._v("ScreenSpaceReflection")])]),s._v(" "),t("li",[t("p",[s._v("DiffuseIndirectComposite")])])]),s._v(" "),t("p",[s._v("SSR的主要计算都包含在第一个Pass，第二个Pass的主要工作则是采样SSRT并进行合成。SSRT的生成代码主要在SSRTReflections.usf文件中的ScreenSpaceReflections函数。主要步骤与上述所讲大致相同，只是UE在挑选计算射线权重使用的函数时并未选择了普通的加权平均，并在合成阶段使用EnvBRDF进行合成，以节省性能。UE中的代码和注释如下")]),s._v(" "),t("div",{staticClass:"language-cpp line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-cpp"}},[t("code",[s._v("BRANCH "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" bHit "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  ClosestHitDistanceSqr "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("min")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("ClosestHitDistanceSqr"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ComputeRayHitSqrDistance")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("PositionTranslatedWorld"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" HitUVz"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  float2 SampleUV"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("float")]),s._v(" Vignette"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ReprojectHit")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("PrevScreenPositionScaleBias"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" GBufferVelocityTexture"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" GBufferVelocityTextureSampler"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" HitUVz"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" SampleUV"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Vignette"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  float4 SampleColor "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("SampleScreenColor")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" SceneColor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" SceneColorSampler"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" SampleUV "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" Vignette"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  SampleColor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rgb "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rcp")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("Luminance")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("SampleColor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rgb"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// Correct integration applies DGF below but for speed we apply EnvBRDF later when compositing")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("if")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")])])]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// CosineSampleHemisphere")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// PDF = NoL / PI,")]),s._v("\n  SampleColor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rgb "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*=")]),s._v(" F "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("D "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" Vis "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" PI"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("elif")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")])])]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ImportanceSampleGGX")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// PDF = D * NoH / (4 * VoH),")]),s._v("\n  SampleColor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rgb "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*=")]),s._v(" F "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v(" NoL "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" Vis "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" VoH "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v(" NoH"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("elif")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token expression"}},[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")])])]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// ImportanceSampleVisibleGGX")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// PDF = G_SmithV * VoH * D / NoV / (4 * VoH)")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// PDF = G_SmithV * D / (4 * NoV);")]),s._v("\n  SampleColor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rgb "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*=")]),s._v(" F "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" G_SmithL"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token macro property"}},[t("span",{pre:!0,attrs:{class:"token directive-hash"}},[s._v("#")]),t("span",{pre:!0,attrs:{class:"token directive keyword"}},[s._v("endif")])]),s._v("\n\n  OutColor "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+=")]),s._v(" SampleColor"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br")])]),t("p",[s._v("UE的实现显然并没有将论文中的观点实现的面面俱到，为了效果或者为了性能都有更多的改进工作可以进行，然而这也是后话了，毕竟UE中的坑实在是太多了。这次就先这样子吧。")])])}),[],!1,null,null,null);t.default=l.exports}}]);